"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
require("dotenv/config");
const grammy_1 = require("grammy");
const config_1 = require("./src/config");
const commandList_1 = require("./src/assets/commandList");
const regexp_1 = require("./src/regexp");
const setState_1 = require("./src/middlewares/setState");
const setUserData_1 = require("./src/middlewares/setUserData");
const router_1 = require("./src/routes/router");
const cmdStart_1 = require("./src/commands/cmdStart");
const initialSession_1 = require("./src/assets/initialSession");
const setPrintTable_1 = require("./src/middlewares/setPrintTable");
const setTimeZone_1 = require("./src/middlewares/setTimeZone");
const cmdPrintToday_1 = require("./src/commands/cmdPrintToday");
const makeRecords_1 = require("./src/hears/makeRecords/makeRecords");
const hidePrevDay_1 = require("./src/hears/makeRecords/hidePrevDay");
const bot = new grammy_1.Bot(config_1.token);
bot.api.setMyCommands(commandList_1.commandList);
bot.use((0, grammy_1.session)({ initial: initialSession_1.initialSession }));
bot.use(setUserData_1.setUserData);
bot.use(setTimeZone_1.setTimeZone);
bot.use(setState_1.setState);
bot.use(setPrintTable_1.setPrintTable);
bot.use(router_1.router);
bot.command('start', cmdStart_1.cmdStart);
bot.command('today', cmdPrintToday_1.cmdPrintToday);
bot.hears(regexp_1.name_and_price, hidePrevDay_1.hidePrevDay, makeRecords_1.makeRecords);
bot.on('message', ctx => ctx.deleteMessage());
bot.start().catch(console.log);
